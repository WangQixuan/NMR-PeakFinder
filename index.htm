<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NMR PeakFinder - 核磁位移查询工具</title>
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon"/>
    <link rel="bookmark" href="favicon.ico" type="image/x-icon"/>
    
    <!-- 外部资源 -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
    <script src="H_NMR.js"></script>
    <script src="C_NMR.js"></script>
    
    <!-- 字体资源 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script type="text/javascript">
        // 查询历史记录
        let searchHistory = JSON.parse(localStorage.getItem('nmrSearchHistory') || '[]');
        
        function queryNMR(e) {
            // 显示加载状态
            const submitBtn = $(e).find('button[type="submit"]');
            const originalText = submitBtn.html();
            submitBtn.prop('disabled', true).html('<i class="fas fa-spinner fa-spin"></i> 查询中...');
            
            clearpage();
            var spec_data = {};
            $(e).serializeArray().forEach(function (item) {
                spec_data[item.name] = item.value;
            });
            
            // 简单验证
            if (!spec_data.chem_shift || isNaN(parseFloat(spec_data.chem_shift))) {
                alert('请输入有效的化学位移值');
                submitBtn.prop('disabled', false).html(originalText);
                return false;
            }
            
            if (parseFloat(spec_data.threshold) < 0) {
                alert('阈值不能为负数');
                submitBtn.prop('disabled', false).html(originalText);
                return false;
            }
            
            // 保存搜索历史
            saveSearchHistory(spec_data);
            updateHistoryDropdown();
            
            var result = [];
            var obj = eval(spec_data.spec_type + "_NMR");
            var nucleus = {'H': 'Proton', 'C': 'Carbon'}[spec_data.spec_type];
            
            // 搜索逻辑优化 - 支持字符串搜索
            obj.forEach(function (item) {
                if (item[spec_data.solvent] == null) return;
                
                // 字符串搜索功能 - 只针对化合物名称
                const textSearch = spec_data.text_search ? spec_data.text_search.toLowerCase() : '';
                const compoundMatch = textSearch && item.compound.toLowerCase().includes(textSearch);
                
                // 化学位移搜索
                const shiftMatch = !textSearch && Math.abs(item[spec_data.solvent] - spec_data.chem_shift) <= spec_data.threshold;
                
                // 满足任一条件即可匹配
                if (compoundMatch || shiftMatch) {
                    result.push({
                        ...item,
                        matchType: compoundMatch ? 'compound' : 'shift'
                    });
                }
            });
            
            // 结果处理与排序
            if (result.length === 0) {
                    let message = "未找到匹配结果";
                    if (spec_data.text_search) {
                        message += `，请尝试调整搜索关键词或增大阈值范围`;
                    } else {
                        message += "，请尝试调整阈值范围";
                    }
                    $("#result tbody").append(`<tr><td colspan='4' class='text-center text-warning'>${message}</td></tr>`);
                } else {
                // 按化合物分组并展示
                const compoundMap = new Map();
                result.forEach(item => {
                    if (!compoundMap.has(item.compound)) {
                        compoundMap.set(item.compound, []);
                    }
                    compoundMap.get(item.compound).push(item);
                });
                
                // 遍历分组后的化合物
                compoundMap.forEach((items, compound) => {
                    items.forEach(item => {
                                // 根据匹配类型设置高亮样式
                        const highlightClass = item.matchType ? ' class="success"' : '';
                        $("#result tbody").append("<tr" + highlightClass + ">" +
                            "<td>" + item.compound + "</td>" +
                            "<td>" + item[nucleus.toLowerCase()] + "</td>" +
                            "<td class='mult'>" + ('mult' in item ? item.mult : '') + "</td>" +
                            "<td>" + item[spec_data.solvent] + "</td>" +
                            "</tr>");
                    });
                });
            }
            
            if (!('mult' in obj[0])) {
                $(".mult").hide();
            }
            
            $("#nucleus").text(nucleus);
            $("#disp_solvent").text($("#solvent").find("option:selected").text());
            $("#result_count").text(result.length);
            $("#result").show();
            $("#result").animate({ opacity: 1 }, 500);
            
            // 平滑滚动到结果区域
            $(
            "html, body").animate({
                scrollTop: $("#result").offset().top - 20
            }, 800);
            
            // 恢复按钮状态
            setTimeout(function() {
                submitBtn.prop('disabled', false).html(originalText);
            }, 500);
            
            return false;
        }

        function showhelp() {
            // 检查模态框是否存在，如果存在则显示，否则使用alert作为备选
            if ($('#helpModal').length) {
                $('#helpModal').modal('show');
            } else {
                alert('帮助文档：\n\nNMR PeakFinder 是一个用于查询核磁化学位移的工具。\n\n使用方法：\n1. 选择核磁图谱类型（¹H-NMR 或 ¹³C-NMR）\n2. 选择溶剂类型\n3. 输入化学位移值和阈值范围\n4. 点击查询按钮查看结果\n\n您也可以直接在搜索框中输入化合物名称进行快速查找。');
            }
        }

        function clearpage() {
            $("#result").css('opacity', 0);
            $(".mult").show();
            $("#result tbody").empty();
        }
        
        // 保存搜索历史
        function saveSearchHistory(spec_data) {
            const historyItem = {
                id: Date.now(),
                type: spec_data.spec_type === 'H' ? '¹H-NMR' : '¹³C-NMR',
                solvent: $("#solvent").find("option:selected").text(),
                shift: spec_data.chem_shift,
                threshold: spec_data.threshold,
                text: spec_data.text_search || '',
                data: spec_data
            };
            
            // 限制历史记录数量为10条
            searchHistory.unshift(historyItem);
            if (searchHistory.length > 10) {
                searchHistory = searchHistory.slice(0, 10);
            }
            
            localStorage.setItem('nmrSearchHistory', JSON.stringify(searchHistory));
        }
        
        // 更新历史记录下拉菜单
        function updateHistoryDropdown() {
            const dropdown = $('#historyDropdown');
            const menu = dropdown.find('.dropdown-menu');
            menu.empty();
                
                if (searchHistory.length === 0) {
                    menu.append('<li class="dropdown-header">无搜索历史</li>');
                    return;
                }
                
                searchHistory.forEach(item => {
                    const li = $("<li></li>");
                    let historyText = `${item.type} | ${item.solvent}`;
                    
                    // 如果有文本搜索内容，添加到历史记录显示中
                    if (item.text) {
                        historyText += ` | 搜索: "${item.text}"`;
                    } else {
                        historyText += ` | δ=${item.shift}±${item.threshold}`;
                    }
                    
                    const a = $(`<a class="dropdown-item" href="#">${historyText}</a>`);
                
                a.click(function() {
                    // 恢复搜索参数
                    $("#spec_type").val(item.data.spec_type);
                    
                    // 查找溶剂选项值
                    const solventText = item.solvent;
                    const solventOption = $("#solvent option").filter(function() {
                        return $(this).text() === solventText;
                    });
                    
                    if (solventOption.length) {
                        $("#solvent").val(solventOption.val());
                    }
                    
                    $("#chem_shift").val(item.data.chem_shift);
                    $("#threshold").val(item.data.threshold);
                    $("#text_search").val(item.data.text_search || '');
                });
                
                li.append(a);
                menu.append(li);
            });
            
            // 添加清除历史记录选项
            menu.append('<div class="dropdown-divider"></div>');
            menu.append('<li><a class="dropdown-item text-danger" href="#" onclick="clearHistory()">清除历史记录</a></li>');
        }
        
        // 清除历史记录
        function clearHistory() {
            searchHistory = [];
            localStorage.removeItem('nmrSearchHistory');
            updateHistoryDropdown();
        }
        
        // 页面加载完成后初始化
        $(document).ready(function() {
            updateHistoryDropdown();
            
            // 添加平滑滚动效果
            $('a[href^="#"]').on('click', function(e) {
                e.preventDefault();
                $(document).off("scroll");
                
                const target = $(this.getAttribute('href'));
                if (target.length) {
                    $('html, body').stop().animate({
                        scrollTop: target.offset().top
                    }, 500);
                }
            });
            
            // 为输入框添加焦点效果
            $('.text-input, .number-input, .select-input').focus(function() {
                $(this).closest('.field-input, .input-with-addon, .input-with-icon').addClass('has-focus');
            }).blur(function() {
                $(this).closest('.field-input, .input-with-addon, .input-with-icon').removeClass('has-focus');
            });
            
            // 数字输入实时验证和格式化
            $('.number-input').on('input', function() {
                // 移除非数字和小数点字符
                let value = $(this).val().replace(/[^0-9.]/g, '');
                // 确保只有一个小数点
                const parts = value.split('.');
                if (parts.length > 2) {
                    value = parts[0] + '.' + parts.slice(1).join('');
                }
                // 限制小数位数为2位
                if (parts.length === 2 && parts[1].length > 2) {
                    value = parts[0] + '.' + parts[1].substring(0, 2);
                }
                $(this).val(value);
            });
            
            // 阈值输入特殊处理（不允许负数）
            $('#threshold').on('input', function() {
                // 禁止输入负号
                if ($(this).val().startsWith('-')) {
                    $(this).val($(this).val().replace('-', ''));
                }
            });
            
            // 文本搜索框添加清除按钮
            $('#text_search').on('input', function() {
                if ($(this).val().length > 0) {
                    // 添加清除按钮（如果不存在）
                    if ($(this).next('.clear-btn').length === 0) {
                        $(this).after('<button type="button" class="clear-btn" aria-label="清除"><i class="fas fa-times"></i></button>');
                        $(this).next('.clear-btn').click(function() {
                            $(this).prev('input').val('').focus();
                            $(this).remove();
                        });
                    }
                } else {
                    // 移除清除按钮
                    $(this).next('.clear-btn').remove();
                }
            });
            
            // 初始检查文本框状态
            if ($('#text_search').val().length > 0) {
                $('#text_search').trigger('input');
            }
        });
    </script>
    <style>
        :root {
            /* 主色调 - 专业科研风格的蓝色系 */
            --primary-color: #1e88e5;
            --primary-light: #64b5f6;
            --primary-dark: #0d47a1;
            
            /* 辅助色 */
            --secondary-color: #26a69a;
            --accent-color: #ff9800;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --info-color: #2196f3;
            
            /* 文本颜色 */
            --text-primary: #212121;
            --text-secondary: #757575;
            --text-hint: #9e9e9e;
            --text-disabled: #bdbdbd;
            --text-inverse: #ffffff;
            
            /* 背景颜色 */
            --bg-primary: #ffffff;
            --bg-secondary: #f5f7fa;
            --bg-tertiary: #e3f2fd;
            --bg-accent: #e1f5fe;
            --bg-card: #ffffff;
            
            /* 边框和阴影 */
            --border-color: #e0e0e0;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.15);
            --shadow-xl: 0 16px 24px rgba(0, 0, 0, 0.2);
            
            /* 间距 */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-xxl: 3rem;
            
            /* 圆角 */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 24px;
            
            /* 字体 */
            --font-family: 'Inter', 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            --font-mono: 'Fira Code', 'Consolas', 'Monaco', 'Andale Mono', monospace;
            
            /* 过渡动画 */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* 保留原有变量以保持兼容性 */
            --dark-text: var(--text-primary);
            --medium-text: var(--text-secondary);
            --light-text: var(--text-hint);
            --light-bg: var(--bg-secondary);
        }
        
        /* 引入Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap');
        
        /* 基础样式重置和通用设置 */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, #e2e8f0 100%);
            font-family: var(--font-family);
            color: var(--text-primary);
            line-height: 1.65;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* 容器样式 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }
        
        /* 标题样式系统 */
        h1, h2, h3, h4, h5, h6 {
            color: var(--text-primary);
            font-weight: 600;
            line-height: 1.3;
            margin-bottom: var(--spacing-md);
        }
        
        h1 {
            font-size: 2.5rem;
        }
        
        h2 {
            font-size: 2rem;
        }
        
        h3 {
            font-size: 1.5rem;
        }
        
        h4 {
            font-size: 1.25rem;
        }
        
        /* 链接样式 */
        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color var(--transition-fast);
        }
        
        a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        a:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        /* 段落样式 */
        p {
            margin-bottom: var(--spacing-md);
            color: var(--text-primary);
        }
        
        /* 列表样式 */
        ul, ol {
            margin-bottom: var(--spacing-md);
            padding-left: var(--spacing-xl);
        }
        
        li {
            margin-bottom: var(--spacing-xs);
        }
        
        #dlgbox {
            margin: 3rem auto;
            padding: 2.5rem;
            background: white;
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
            background: linear-gradient(135deg, white 0%, #f8fafc 100%);
        }
        
        #dlgbox::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        
        #dlgbox:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-2px);
        }
        
        /* 帮助弹窗样式 */
        #helpModal .modal-dialog {
            max-width: 800px;
            margin: 1.75rem auto;
        }
        
        #helpModal .modal-content {
            border: none;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            position: relative;
            animation: modalContentAppear 0.4s ease-out;
        }
        
        /* 弹窗淡入动画 */
        @keyframes modalContentAppear {
            0% {
                transform: scale(0.95);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        #helpModal .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        
        .help-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem 2rem;
            background-color: var(--bg-secondary);
            border-bottom: none;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .modal-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .help-modal-header:hover .modal-icon {
            transform: rotate(15deg) scale(1.1);
        }
        
        .modal-title {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .help-close-button {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .help-close-button:hover {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            transform: scale(1.1) rotate(90deg);
        }
        
        .help-modal-body {
            padding: 2rem;
        }
        
        .help-sections {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        .help-section {
            display: flex;
            gap: 1.5rem;
            align-items: center;
            padding: 1.5rem;
            background-color: var(--bg-card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid transparent;
            opacity: 0;
            transform: translateY(20px);
            animation: sectionSlideIn 0.5s ease-out forwards;
            flex-wrap: nowrap;
            flex-direction: row; /* 明确指定为水平方向 */
        }
        
        /* 区块依次滑入动画 */
        .help-section:nth-child(1) { animation-delay: 0.1s; }
        .help-section:nth-child(2) { animation-delay: 0.2s; }
        .help-section:nth-child(3) { animation-delay: 0.3s; }
        .help-section:nth-child(4) { animation-delay: 0.4s; }
        .help-section:nth-child(5) { animation-delay: 0.5s; }
        
        @keyframes sectionSlideIn {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .help-section:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .help-section:nth-child(1):hover {
            border-left-color: var(--primary-color);
        }
        
        .help-section:nth-child(2):hover {
            border-left-color: var(--secondary-color);
        }
        
        .help-section:nth-child(3):hover {
            border-left-color: var(--accent-color);
        }
        
        .help-section:nth-child(4):hover {
            border-left-color: var(--warning-color);
        }
        
        .section-icon-container {
            flex-shrink: 0;
            min-width: 50px; /* 确保图标容器不会被压缩 */
        }
        
        .section-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: white;
            font-size: 1.3rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .help-section:hover .section-icon {
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .search-icon {
            background-color: var(--primary-color);
        }
        
        .results-icon {
            background-color: var(--secondary-color);
        }
        
        .search-text-icon {
            background-color: var(--accent-color);
        }
        
        .hint-icon {
            background-color: var(--warning-color);
        }
        
        .section-content {
            flex: 1;
            min-width: 0; /* 允许内容区域缩小，防止溢出 */
        }

        .section-title {
            margin: 0 0 1rem 0;
            font-size: 1.2rem;
            font-weight: 600;
            /* color: var(--text-primary); */
            transition: color 0.3s ease, transform 0.3s ease;
            white-space: nowrap; /* 标题保持在一行 */
            overflow: hidden;
            text-overflow: ellipsis; /* 当标题过长时显示省略号 */
        }
        
        .help-section:hover .section-title {
            color: var(--primary-color);
            transform: translateX(2px);
        }
        
        .section-description {
            margin: 0 0 1rem 0;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .section-list {
            margin: 0 0 0 1.5rem;
            padding: 0;
            color: var(--text-secondary);
        }
        
        .section-list li {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }
        
        .section-note {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 1rem;
            background-color: var(--bg-accent);
            border-radius: var(--radius-md);
            margin-top: 1rem;
            color: var(--text-secondary);
            font-size: 0.95rem;
            border-left: 3px solid var(--info-color);
            transition: all 0.3s ease;
        }
        
        .help-section:hover .section-note {
            background-color: rgba(91, 192, 222, 0.1);
            transform: translateX(3px);
        }
        
        .section-note i {
            margin-top: 0.2rem;
            color: var(--info-color);
            animation: pulse 2s infinite;
        }
        
        /* 图标脉冲动画 */
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }
        
        .hint-section {
            background-color: rgba(255, 152, 0, 0.05);
        }
        
        .help-modal-footer {
            display: flex;
            justify-content: center;
            padding: 1.5rem 2rem;
            background-color: var(--bg-secondary);
            border-top: none;
        }
        
        .help-close-btn {
            min-width: 120px;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            #helpModal .modal-dialog {
                margin: 0.5rem;
                max-width: 100%;
            }
            
            .help-modal-header {
                padding: 1.25rem 1.5rem;
            }
            
            .modal-title {
                font-size: 1.3rem;
            }
            
            .help-modal-body {
                padding: 1.5rem;
            }
            
            .help-section {
                flex-direction: row; /* 保持左右结构 */
                padding: 1.25rem;
                gap: 1rem;
            }
            
            .section-icon-container {
                flex-shrink: 0;
                min-width: 45px; /* 适配小屏幕图标大小 */
            }
            
            .section-icon {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
            
            .section-title {
                font-size: 1.1rem;
            }
            
            .section-list {
                margin-left: 1rem;
                text-align: left;
            }
            
            .section-note {
                text-align: left;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .help-modal-header {
                padding: 1rem 1.25rem;
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .header-left {
                justify-content: center;
            }
            
            .modal-title {
                font-size: 1.2rem;
            }
            
            .help-modal-body {
                padding: 1.25rem;
            }
            
            .help-sections {
                gap: 1.25rem;
            }
            
            .help-section {
                padding: 1rem;
            }
            
            .section-icon {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .section-description {
                font-size: 0.9rem;
                line-height: 1.5;
            }
            
            .section-list li {
                font-size: 0.85rem;
            }
            
            .help-modal-footer {
                padding: 1.25rem 1.5rem;
            }
            
            .help-close-btn {
                min-width: 100px;
                padding: 0.6rem 1rem;
            }
        }
        
        h2 {
            margin: 0 auto 1.5rem;
            font-weight: 700;
            text-align: center;
            font-size: 2.5rem;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: block;
            position: relative;
        }
        
        h2 + p {
            font-size: 1.1rem;
            color: var(--medium-text);
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .input_group {
            margin-bottom: 1.5rem;
            padding: 0.5rem 0;
            transition: var(--transition);
        }
        
        .input_group.has-focus {
            transform: translateX(2px);
        }
        
        .input_label {
            font-weight: 600;
            color: var(--dark-text);
            margin-bottom: 0.5rem;
            display: block;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }
        
        /* 添加标签动画 */
        .input_group:focus-within .input_label {
            color: var(--primary-color);
            transform: translateX(2px);
        }
        
        .form-control {
            border-radius: var(--radius-lg);
            border: 2px solid var(--border-color);
            transition: var(--transition);
            padding: 0.75rem 1rem;
            font-size: 1rem;
            background-color: white;
            width: 100%;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(26, 115, 232, 0.15);
            background-color: white;
            transform: translateY(-1px);
        }
        
        .form-control:disabled {
            background-color: var(--light-bg);
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        /* 增强输入组样式 */
        .input-group {
            border-radius: var(--radius-lg);
            overflow: hidden;
            display: flex;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }
        
        .input-group:focus-within {
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
        }
        
        .input-group-text {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: 600;
            min-width: 44px;
            justify-content: center;
            display: flex;
            align-items: center;
            padding: 0.75rem 0.75rem;
            border: none;
        }
        
        .input-group .form-control,
        .input-group .text-input {
            border-radius: 0;
            border-left: none;
            flex: 1;
            box-shadow: none !important;
            width: auto;
            padding: 0.75rem 1rem;
        }
        
        /* 字符串搜索框样式 */
        .search-icon {
            background-color: var(--secondary-color);
        }
        
        /* 修复输入组的边框问题 */
        .input-group .form-control:focus {
            border-color: var(--primary-color);
        }
        
        /* 按钮基础样式 */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            font-weight: 600;
            transition: var(--transition);
            margin: 0 var(--spacing-sm);
            box-shadow: var(--shadow-md);
            border: none;
            text-transform: none;
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            font-size: 1rem;
            line-height: 1.5;
            cursor: pointer;
            text-decoration: none;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }
        
        /* 按钮悬停效果 */
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        /* 按钮点击效果 */
        .btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-md);
        }
        
        /* 按钮焦点效果 */
        .btn:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        /* 按钮禁用状态 */
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: var(--shadow-sm) !important;
        }
        
        /* 按钮点击波纹效果 */
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.7);
            opacity: 0;
            border-radius: 50%;
            transform: scale(1, 1) translate(-50%, -50%);
            transform-origin: 50% 50%;
        }
        
        .btn:focus:not(:active)::after {
            animation: ripple 0.6s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            20% {
                transform: scale(25, 25);
                opacity: 0.3;
            }
            100% {
                opacity: 0;
                transform: scale(50, 50);
            }
        }
        
        /* 表单元素基础样式 */
        .form-control {
            border-radius: var(--radius-lg);
            border: 2px solid var(--border-color);
            transition: var(--transition);
            padding: 0.75rem 1rem;
            font-size: 1rem;
            background-color: var(--bg-primary);
            width: 100%;
            color: var(--text-primary);
            font-family: var(--font-family);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(30, 136, 229, 0.15);
            background-color: var(--bg-primary);
            transform: translateY(-1px);
        }
        
        .form-control:disabled {
            background-color: var(--bg-secondary);
            opacity: 0.7;
            cursor: not-allowed;
            border-color: var(--border-color);
        }
        
        /* 增强输入组样式 */
        .input-group {
            border-radius: var(--radius-lg);
            overflow: hidden;
            display: flex;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }
        
        .input-group:focus-within {
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.1);
            transform: translateY(-1px);
        }
        
        .input-group-text {
            background-color: var(--primary-color);
            color: var(--text-inverse);
            border-color: var(--primary-color);
            font-weight: 600;
            min-width: 44px;
            justify-content: center;
            display: flex;
            align-items: center;
            padding: 0.75rem 0.75rem;
            border: none;
            font-size: 1rem;
        }
        
        .input-group .form-control {
            border-radius: 0;
            border-right: none;
            flex: 1;
            box-shadow: none !important;
        }
        
        /* 按钮样式变体 */
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--text-inverse);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            color: var(--text-inverse);
        }
        
        .btn-primary:active {
            background-color: var(--primary-dark);
            color: var(--text-inverse);
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: var(--text-inverse);
        }
        
        .btn-success:hover {
            background-color: #388e3c;
            color: var(--text-inverse);
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--text-inverse);
        }
        
        .btn-secondary:hover {
            background-color: #00897b;
            color: var(--text-inverse);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            box-shadow: var(--shadow-sm);
        }
        
        .btn-outline:hover {
            background-color: var(--primary-color);
            color: var(--text-inverse);
            border-color: var(--primary-color);
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: var(--text-inverse);
        }
        
        .btn-warning:hover {
            background-color: #f57c00;
            color: var(--text-inverse);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: var(--text-inverse);
        }
        
        .btn-danger:hover {
            background-color: #d32f2f;
            color: var(--text-inverse);
        }
        
        /* 应用容器和组件样式 */
        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* 导航栏样式 */
        .app-header {
            background-color: var(--bg-primary);
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: var(--spacing-md) 0;
            transition: var(--transition);
        }
        
        .app-header:hover {
            box-shadow: var(--shadow-lg);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }
        
        .brand {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .brand:hover {
            transform: translateY(-2px);
        }
        
        .brand-icon {
            font-size: 1.8rem;
            color: var(--primary-color);
        }
        
        .brand-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }
        
        .nav-menu {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
        }
        
        .nav-item {
            color: var(--text-secondary);
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-md);
            transition: var(--transition);
            text-decoration: none;
            font-weight: 500;
        }
        
        .nav-item:hover {
            color: var(--primary-color);
            background-color: var(--bg-secondary);
        }
        
        /* 主内容区域 */
        .app-main {
            flex: 1;
            padding: var(--spacing-xl) 0;
        }
        
        /* 英雄区域 */
        .hero-section {
            text-align: center;
            margin-bottom: var(--spacing-xxl);
            padding: var(--spacing-xxl) var(--spacing-md);
            background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-accent) 100%);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .page-description {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* 查询卡片样式 */
        .query-card {
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: var(--transition);
            margin-bottom: var(--spacing-xxl);
        }
        
        .query-card:hover {
            box-shadow: var(--shadow-xl);
        }
        
        .query-form {
            background-color: var(--bg-card);
            padding: var(--spacing-xl);
            border: none;
        }
        
        .query-form.rounded-none {
            border-radius: 0;
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: var(--text-inverse);
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-header.rounded-top {
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }
        
        .card-content {
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
            overflow: hidden;
        }
        
        .card-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            margin: auto;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            /* color: var(--text-inverse); */
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        /* 表单字段样式 */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .form-field {
            margin-bottom: var(--spacing-lg);
        }
        
        .field-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
            font-size: 0.95rem;
        }
        
        .field-icon {
            margin-right: var(--spacing-sm);
            color: var(--primary-color);
        }
        
        .input-with-addon {
            position: relative;
            display: flex;
            width: 100%;
        }
        
        .number-input,
        .text-input,
        .select-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .number-input:focus,
        .text-input:focus,
        .select-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(30, 136, 229, 0.15);
            transform: translateY(-1px);
        }
        
        .input-addon {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            padding: 0 var(--spacing-md);
            background-color: var(--bg-secondary);
            color: var(--text-secondary);
            border-left: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            font-size: 0.9rem;
            pointer-events: none;
        }
        
        /* 清除按钮样式 */
        .clear-btn {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .clear-btn:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }
        
        .clear-btn:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        /* 确保输入框有足够的右侧空间容纳清除按钮 */
        .input-with-icon .text-input {
            padding-right: 2.5rem;
        }
        
        .field-hint {
            margin-top: var(--spacing-xs);
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        /* 按钮容器 */
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            margin-top: var(--spacing-xl);
            flex-wrap: wrap;
        }
        
        /* 结果展示区域 */
        .result-container {
            margin-top: var(--spacing-xl);
            background-color: var(--bg-card);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transition: all 0.5s ease;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            background-color: var(--primary-color);
            color: var(--text-inverse);
        }
        
        .result-meta {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            font-size: 0.9rem;
        }
        
        .table-wrapper {
            overflow-x: auto;
            padding: var(--spacing-lg);
        }
        
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.95rem;
        }
        
        .data-table th {
            background-color: var(--primary-color);
            color: var(--text-inverse);
            font-weight: 600;
            text-align: left;
            padding: 1rem;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }
        
        .data-table th:first-child {
            border-radius: var(--radius-md) 0 0 var(--radius-md);
        }
        
        .data-table th:last-child {
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
        }
        
        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-primary);
            transition: var(--transition);
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        .data-table tr:hover td {
            background-color: rgba(30, 136, 229, 0.05);
        }
        
        .peak-multiplicity {
            font-family: var(--font-mono);
            font-weight: 500;
            color: var(--secondary-color);
        }
        
        /* 参考信息区域 */
        .reference-section {
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
            background-color: var(--bg-card);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: var(--transition);
        }
        
        .reference-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .reference-entry {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md) 0;
        }
        
        .entry-icon {
            font-size: 1.25rem;
            color: var(--primary-color);
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-tertiary);
            border-radius: 50%;
        }
        
        .entry-content {
            flex: 1;
        }
        
        .entry-label {
            font-weight: 600;
            color: var(--text-secondary);
            margin-right: var(--spacing-xs);
        }
        
        .entry-link {
            color: var(--primary-color);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .entry-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        /* 页脚样式 */
        .page-footer {
            background-color: var(--bg-primary);
            padding: var(--spacing-xl) 0;
            border-top: 1px solid var(--border-color);
            margin-top: auto;
        }
        
        .footer-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
            text-align: center;
        }
        
        .footer-text {
            color: var(--text-secondary);
        }
        
        .copyright {
            font-size: 0.9rem;
            margin-bottom: var(--spacing-sm);
        }
        
        .footer-description {
            font-size: 0.9rem;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
        }
        
        .footer-description a {
            transition: var(--transition);
        }
        
        .footer-description a:hover {
            transform: translateX(2px);
        }
        
        .table tbody tr.success {
            background-color: rgba(52, 168, 83, 0.1);
            font-weight: 500;
        }
        
        .table tbody tr.success td {
            background-color: rgba(52, 168, 83, 0.05);
            color: var(--secondary-color);
            font-weight: 600;
            border-bottom-color: rgba(52, 168, 83, 0.2);
        }
        
        /* 表格行之间的分隔线 */
        .table tbody tr:not(:last-child) td {
            border-bottom: 1px solid var(--border-color);
        }
        
        .footer {
            margin-top: 3rem;
            padding: 2rem;
            background-color: white;
            border-radius: var(--radius-xl);
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            border: 1px solid var(--border-color);
        }
        
        .footer:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        /* 已合并到前面的.reference-section定义 */
        
        .reference-section:hover {
            box-shadow: var(--shadow-xl);
        }
        
        .reference-section .card-content {
            background-color: var(--bg-card);
            padding: 1.25rem;
            border: none;
            min-height: auto;
        }
        
        .reference-section h5 {
            margin-bottom: 0.75rem;
            color: var(--dark-text);
            font-weight: 600;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .reference-section a {
            color: var(--primary-color);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 500;
            position: relative;
            padding-bottom: 2px;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        /* 确保参考文献位置一致和换行 */
        .reference-entry:nth-child(2) {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            padding: var(--spacing-md) 0;
        }

        .reference-entry:nth-child(2) .entry-content {
            flex: 1;
        }

        .reference-entry:nth-child(2) .entry-link {
            display: inline-block;
            white-space: normal;
            max-width: 100%;
        }
        
        .reference-section a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
        }
        
        .reference-section a:hover {
            color: var(--primary-dark);
        }
        
        .reference-section a:hover::after {
            width: 100%;
        }
        
        /* 链接图标 */
        .reference-section a i {
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        /* 响应式设计优化 */
        /* 超大屏幕优化 */
        @media (min-width: 1200px) {
            .app-container {
                max-width: 1400px;
            }
            
            .hero-section h1 {
                font-size: 3rem;
            }
            
            .hero-section p {
                font-size: 1.25rem;
            }
        }
        
        /* 大屏幕优化 */
        @media (min-width: 992px) and (max-width: 1199px) {
            .app-container {
                max-width: 1000px;
            }
        }
        
        /* 中等屏幕优化 */
        @media (min-width: 769px) and (max-width: 991px) {
            .app-container {
                max-width: 90%;
            }
            
            .form-row {
                flex-direction: column;
                gap: var(--spacing-md);
            }
            
            .form-field {
                width: 100%;
            }
        }
        
        /* 平板设备优化 */
        @media (max-width: 768px) {
            #dlgbox {
                margin: 10% auto;
                padding: 1.75rem;
                width: 95%;
                max-width: none;
                margin-top: 1.5rem;
            }
            
            h2 {
                font-size: 1.8rem;
            }
            
            .form-field {
                margin-bottom: 1.25rem;
            }
            
            .btn-group {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.75rem;
                width: 100%;
            }
            
            .btn {
                margin-bottom: 0.75rem;
                width: calc(50% - 0.5rem);
                min-width: 120px;
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
                margin-left: 0;
                margin-right: 0;
            }
            
            #result {
                padding: 1.25rem;
                margin: 1.5rem auto;
                width: 95%;
                overflow-x: auto;
            }
            
            .table th, .table td {
                padding: 0.75rem;
                font-size: 0.85rem;
                white-space: nowrap;
            }
            
            /* 已合并到前面的.reference-section .card-content定义 */
            
            .reference-section {
                border-radius: var(--radius-lg);
                max-width: 100%;
                margin-left: auto;
                margin-right: auto;
            }
            
            .footer {
                padding: 1.5rem;
                margin: 1.5rem auto;
                width: 95%;
            }
            
            /* 优化输入字段在移动设备上的显示 */
            .input-with-icon, .input-with-addon {
                width: 100%;
            }
        }
        
        /* 小屏幕手机优化 */
        @media (max-width: 576px) {
            #dlgbox {
                margin: 5% auto;
                padding: 1.5rem;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 0.75rem;
            }
            
            #historyDropdown {
                width: 100%;
            }
            
            /* 适配移动设备的表格 */
            .table {
                font-size: 0.8rem;
                min-width: 600px;
            }
            
            .table th, .table td {
                padding: 0.5rem;
            }
            
            /* 优化导航栏在小屏幕上的显示 */
            .app-header {
                padding: var(--spacing-md) var(--spacing-sm);
            }
            
            .brand {
                font-size: 1.2rem;
            }
            
            /* 优化英雄区域在小屏幕上的显示 */
            .hero-section {
                padding: var(--spacing-xs) var(--spacing-xs);
                max-height: 150px;
                margin-bottom: var(--spacing-sm);
            }
            
            .hero-section h1,
            .page-title {
                font-size: 1.4rem;
                margin-bottom: var(--spacing-xs);
                line-height: 1.2;
            }
            
            /* 确保表单元素在小屏幕上完全可见 */
            .query-form {
                padding: var(--spacing-lg) var(--spacing-md);
            }
        }
        
        /* 增强动画效果 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in-up {
            animation: fadeInUp 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        }
        
        /* 添加平滑渐变动画 */
        @keyframes gradientShimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* 为标题添加渐变闪烁效果 */
        h2 {
            background: linear-gradient(-45deg, var(--primary-color), var(--secondary-color), var(--primary-light));
            background-size: 400% 400%;
            animation: gradientShimmer 6s ease infinite;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        /* 添加页面加载动画 */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        body {
            animation: fadeIn 0.5s ease-in;
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--light-bg);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--light-text);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--medium-text);
        }
        
        /* 增强历史记录下拉菜单样式 */
        .dropdown-menu {
            max-height: 350px;
            overflow-y: auto;
            min-width: 300px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-xl);
            padding: 0.5rem;
            margin-top: 0.5rem;
            background-color: white;
        }
        
        .dropdown-item {
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            border-radius: var(--radius-md);
            margin-bottom: 0.25rem;
            transition: var(--transition);
            display: block;
            position: relative;
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .dropdown-item:last-child {
            margin-bottom: 0;
        }
        
        .dropdown-item:hover {
            background-color: rgba(26, 115, 232, 0.1);
            transform: translateX(2px);
            color: var(--primary-color);
        }
        
        .dropdown-item.text-danger:hover {
            background-color: rgba(234, 67, 53, 0.1);
            color: var(--danger-color);
        }
        
        .dropdown-divider {
            margin: 0.5rem 0;
            background-color: var(--border-color);
        }
        
        /* 下拉菜单箭头指示器 */
        .dropdown-menu::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid white;
            z-index: 10;
        }
        
        /* 下拉菜单容器 */
        .dropdown {
            position: relative;
        }
        
        /* 全面响应式设计 */
        @media (max-width: 1200px) {
            .app-container {
                max-width: 95%;
            }
        }
        
        @media (max-width: 992px) {
            .header-content {
                padding: 0 var(--spacing-lg);
            }
            
            .app-main {
                margin-top: 20px;
                padding: 0 var(--spacing-lg);
            }
            
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            /* 查询卡片移动端优化 */
            .query-card {
                width: 100%;
                margin-top: var(--spacing-lg);
                margin-bottom: var(--spacing-xl);
                border-radius: var(--radius-lg);
            }
            
            .card-header.rounded-top {
                border-radius: var(--radius-lg) var(--radius-lg) 0 0;
                padding: var(--spacing-md);
            }
            
            .card-content {
                border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            }
            
            .query-form {
                padding: var(--spacing-lg);
            }
            
            /* 导航栏响应式 */
            .header-content {
                flex-direction: column;
                padding: var(--spacing-md);
                gap: var(--spacing-md);
            }
            
            .brand {
                align-items: center;
            }
            
            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
                gap: var(--spacing-sm);
            }
            
            .nav-item {
                margin: 0;
            }
            
            /* 英雄区域响应式 */
            .hero-section {
                padding: var(--spacing-sm) var(--spacing-sm);
                text-align: center;
                margin-bottom: var(--spacing-md);
                max-height: 180px;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            
            .page-title {
                font-size: 1.6rem;
                margin-bottom: var(--spacing-sm);
                line-height: 1.2;
            }
            
            .page-description {
                font-size: 0.9rem;
                margin-bottom: 0;
                line-height: 1.3;
            }
            
            .page-description {
                font-size: 1.1rem;
            }

            .card-title {
                font-size: 1.4rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: var(--spacing-md);
            }
            
            /* 按钮容器响应式 */
            .buttons-container {
                flex-direction: column;
                gap: var(--spacing-sm);
            }
            
            .buttons-container .btn {
                width: 100%;
                margin: 0;
            }
            
            /* 结果区域响应式 */
            .result-container {
                margin-top: var(--spacing-lg);
            }
            
            .result-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-md);
                padding: var(--spacing-lg);
            }
            
            .result-meta {
                flex-wrap: wrap;
                gap: var(--spacing-md);
            }
            
            .table-wrapper {
                padding: var(--spacing-md);
                overflow-x: auto;
            }
            
            .data-table {
                font-size: 0.85rem;
                min-width: 640px;
            }
            
            .data-table th,
            .data-table td {
                padding: 0.75rem;
            }
            
            /* 参考信息响应式 */
            .reference-list {
                grid-template-columns: 1fr;
                gap: var(--spacing-md);
            }
            
            .reference-entry {
                padding: var(--spacing-sm) 0;
            }
            
            /* 页脚响应式 */
            .footer-wrapper {
                padding: 0 var(--spacing-md);
            }
            
            .footer-description {
                flex-direction: column;
                align-items: center;
                gap: var(--spacing-xs);
                text-align: center;
            }
        }
        
        @media (max-width: 576px) {
            .app-container {
                max-width: 100%;
            }
            
            .app-main {
                padding: var(--spacing-xs) var(--spacing-sm);
            }
            
            /* 小屏幕手机查询卡片优化 */
            .query-card {
                border-radius: var(--radius-md);
                margin-top: var(--spacing-md);
                max-width: 100%;
                margin-left: auto;
                margin-right: auto;
            }
            
            .reference-section {
                border-radius: var(--radius-md);
                margin-top: var(--spacing-md);
            }
            
            .reference-section .card-content {
                padding: var(--spacing-xs);
            }
            
            .reference-list {
                gap: var(--spacing-sm);
            }
            
            .reference-entry {
                padding: var(--spacing-xs) 0;
            }
            
            .card-header.rounded-top {
                border-radius: var(--radius-md) var(--radius-md) 0 0;
                padding: var(--spacing-sm) var(--spacing-md);
            }
            
            .card-content {
                border-radius: 0 0 var(--radius-md) var(--radius-md);
            }
            
            .query-form {
                padding: var(--spacing-md);
            }
            
            .card-title {
                font-size: 1.2rem;
            }
            
            .page-title {
                font-size: 1.8rem;
            }
            
            /* 小屏幕英雄区域优化 */
            .hero-section {
                padding: var(--spacing-md) var(--spacing-sm);
            }
            
            .data-table {
                font-size: 0.8rem;
            }
            
            .number-input,
            .text-input,
            .select-input {
                font-size: 0.95rem;
                padding: 0.6rem 0.9rem;
            }
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.03);
            }
            100% {
                transform: scale(1);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* 应用动画类 */
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }
        
        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }
        
        .slide-in {
            animation: slideIn 0.4s ease forwards;
        }
        
        /* 滚动条美化 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: var(--radius-full);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: var(--radius-full);
            transition: var(--transition);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1312522788867259"
     crossorigin="anonymous"></script>
</head>
<body>
    <!-- 页面容器 -->
    <div class="app-container">
        <!-- 导航栏组件 -->
        <header class="app-header">
            <div class="container">
                <div class="header-content">
                    <!-- 品牌标识 -->
                    <div class="brand">
                        <i class="fas fa-flask-alt brand-icon"></i>
                        <span class="brand-title">NMR PeakFinder</span>
                    </div>
                    
                    <!-- 导航菜单 -->
                    <nav class="nav-menu">
                        <button type="button" class="nav-item" onclick="showhelp()" aria-label="帮助">
                            <i class="fas fa-question-circle nav-icon"></i>
                            <span class="nav-text">帮助</span>
                        </button>
                        <a href="https://github.com/WangQixuan/NMR-PeakFinder" target="_blank" class="nav-item github-link" aria-label="GitHub">
                            <i class="fab fa-github nav-icon"></i>
                            <span class="nav-text">GitHub</span>
                        </a>
                    </nav>
                </div>
            </div>
        </header>

        <!-- 主要内容区域 -->
        <main class="app-main">
            <div class="container">
                <!-- 英雄区域组件 -->
                <section class="hero-section">
                    <h1 class="page-title">核磁峰值查询工具</h1>
                    <p class="page-description">快速查询常见核磁化学位移</p>
                </section>

                <!-- 查询表单组件 -->
                <section class="query-card">
                    <div class="card-header rounded-top">
                        <h2 class="card-title">查询参数设置</h2>
                    </div>
                    <div class="card-content">
                        <form id="spec_info" onsubmit="return queryNMR(this)" class="query-form rounded-none">
                        <!-- 基础参数设置 -->
                        <div class="form-section">
                            <h3 class="section-title">基础参数</h3>
                            <div class="form-row">
                                <div class="form-field">
                                    <label class="field-label" for="spec_type">
                                        <i class="fas fa-sync-alt field-icon"></i>
                                        核磁图谱类型
                                    </label>
                                    <div class="field-input">
                                        <select id="spec_type" name="spec_type" required="required" class="select-input">
                                            <option value="H">¹H-NMR</option>
                                            <option value="C">¹³C-NMR</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-field">
                                    <label class="field-label" for="solvent">
                                        <i class="fas fa-flask field-icon"></i>
                                        溶剂
                                    </label>
                                    <div class="field-input">
                                        <select id="solvent" name="solvent" required="required" class="select-input">
                                            <option value="chloroform_d">CDCl₃ (氯仿-d)</option>
                                            <option value="acetone_d6">(CD₃)₂CO (丙酮-d₆)</option>
                                            <option value="dmso_d6">(CD₃)₂SO (二甲亚砜-d₆)</option>
                                            <option value="benzene_d6">C₆D₆ (苯-d₆)</option>
                                            <option value="acetonitrile_d3">CD₃CN (乙腈-d₃)</option>
                                            <option value="methanol_d4">CD₃OD (甲醇-d₄)</option>
                                            <option value="water_d2">D₂O (重水)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
        
                        <!-- 化学位移参数设置 -->
                        <div class="form-section">
                            <h3 class="section-title">化学位移参数</h3>
                            <div class="form-row">
                                <div class="form-field">
                                    <label class="field-label" for="chem_shift">
                                        <i class="fas fa-wave-square field-icon"></i>
                                        化学位移 (Chemical Shift)
                                    </label>
                                    <div class="input-with-addon">
                                        <input type="number" id="chem_shift" name="chem_shift" value="0.00" step="0.01" class="number-input">
                                        <span class="input-addon">ppm</span>
                                    </div>
                                </div>
                                <div class="form-field">
                                    <label class="field-label" for="threshold">
                                        <i class="fas fa-sliders-h field-icon"></i>
                                        阈值范围 (Threshold)
                                    </label>
                                    <div class="input-with-addon">
                                        <input type="number" id="threshold" name="threshold" value="0.10" step="0.01" min="0.00" class="number-input">
                                        <span class="input-addon">ppm</span>
                                    </div>
                                </div>
                            </div>
                        </div>
        
                        <!-- 字符串搜索功能 -->
                        <div class="form-section">
                            <h3 class="section-title">快速搜索</h3>
                            <div class="form-field">
                                <label class="field-label" for="text_search">
                                    <i class="fas fa-search field-icon"></i>
                                    化合物名称搜索
                                </label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-search"></i>
                                        </span>
                                    </div>
                                    <input type="text" id="text_search" name="text_search" placeholder="输入化合物名称（如 methanol、acetone 等）" class="text-input">
                                </div>
                                <div class="field-hint">搜索将仅针对化合物名称列进行匹配</div>
                            </div>
                        </div>
        
                        <!-- 操作按钮区域 -->
                        <div class="form-actions">
                            <div class="buttons-container">
                                <button type="reset" class="btn btn-secondary" onclick="clearpage()">
                                    <i class="fas fa-redo-alt"></i> 重置
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-search"></i> 查询
                                </button>
                                <!-- 搜索历史按钮 -->
                                <div class="dropdown">
                                    <button type="button" class="btn btn-outline dropdown-toggle" id="historyDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fas fa-history"></i> 搜索历史
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="historyDropdown">
                                        <div class="dropdown-header">无搜索历史</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </section>
    
                <!-- 结果展示区域 -->
                <section id="result" class="result-container fade-in-up">
                    <div class="card-header">
                        <div class="result-header">
                            <h3 class="section-title">
                                <i class="fas fa-table"></i> 查询结果
                                <span class="result-count">
                                    (<span id="result_count">0</span> 个匹配结果)
                                </span>
                            </h3>
                            <div class="result-meta">
                                <span id="nucleus">Proton</span> NMR peaks in 
                                <span id="disp_solvent">Water</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="table-wrapper">
                            <table class="data-table">
                                <thead>
                                <tr>
                                    <th>化合物</th>
                                    <th><span id="nucleus_header">Proton</span></th>
                                    <th class="peak-multiplicity">多重峰</th>
                                    <th><span id="disp_solvent_header">Water</span> (ppm)</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- 参考信息区域 -->
                <section class="reference-section fade-in-up">
                    <div class="card-header rounded-top">
                        <h2 class="card-title"><i class="fas fa-info-circle"></i> 参考信息</h2>
                    </div>
                    <div class="card-content">
                        <div class="reference-list">
                            <div class="reference-entry">
                                <i class="fas fa-user-circle entry-icon"></i>
                                <div class="entry-content">
                                    <span class="entry-label">作者:</span>
                                    <a href="http://www.wangqixuan.cn" target="_blank" class="entry-link">
                                        WangQixuan <i class="fas fa-external-link-alt"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="reference-entry">
                                <i class="fas fa-book entry-icon"></i>
                                <div class="entry-content">
                                    <span class="entry-label">参考文献:</span>
                                    <a href="jo971176v.pdf" target="_blank" class="entry-link">
                                        <i>J. Org. Chem.</i> <b>1997</b>, <i>62</i>(21), 7512–7515 <i class="fas fa-file-pdf"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="reference-entry">
                                <i class="fas fa-download entry-icon"></i>
                                <div class="entry-content">
                                    <span class="entry-label">下载:</span>
                                    <a href="https://github.com/WangQixuan/NMR-PeakFinder/archive/refs/heads/main.zip" target="_blank" class="entry-link">
                                        下载 NMR-PeakFinder 本地版本 <i class="fas fa-download"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- 页脚区域 -->
        <footer class="page-footer">
            <div class="container">
                <div class="footer-wrapper">
                    <div class="footer-text">
                        <p class="copyright">© 2025 - WangQixuan, All Rights Reserved</p>
                        <p class="footer-description">
                            <i class="fas fa-microscope"></i> NMR PeakFinder - 核磁位移查询工具
                        </p>
                    </div>
                </div>
            </div>
        </footer>

<!-- 帮助模态框 - 现代化设计 -->
<div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header help-modal-header">
                <div class="header-left">
                    <div class="modal-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h5 class="modal-title" id="helpModalLabel">
                        NMR PeakFinder 使用帮助
                    </h5>
                </div>
                <button type="button" class="close help-close-button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body help-modal-body">
                <div class="help-sections">
                    <!-- 简介 -->
                    <div class="help-section">
                        <div class="section-icon-container">
                            <div class="section-icon search-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                        </div>
                        <div class="section-content">
                            <h6 class="section-title">关于 NMR PeakFinder</h6>
                            <p class="section-description">NMR PeakFinder 是一个核磁化学位移查询工具，帮助研究人员快速识别常见NMR 峰值。</p>
                        </div>
                    </div>
                    
                    <!-- 查询方法 -->
                    <div class="help-section">
                        <div class="section-icon-container">
                            <div class="section-icon search-icon">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <div class="section-content">
                            <h6 class="section-title">查询方法</h6>
                            <p class="section-description">要查找特定范围内的峰值（如 50.00±0.10 ppm），请按照以下步骤操作：</p>
                            <ol class="section-list">
                                <li>选择核图谱类型（¹H-NMR 或 ¹³C-NMR）</li>
                                <li>选择适当的溶剂类型</li>
                                <li>将「化学位移」设置为 50.00</li>
                                <li>将「阈值」设置为 0.10</li>
                                <li>点击「查询」按钮显示结果</li>
                            </ol>
                        </div>
                    </div>
                    
                    <!-- 结果解读 -->
                    <div class="help-section">
                        <div class="section-icon-container">
                            <div class="section-icon results-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                        </div>
                        <div class="section-content">
                            <h6 class="section-title">结果解读</h6>
                            <p class="section-description">查询结果以表格形式显示，包含以下信息：</p>
                            <ul class="section-list">
                                <li>浅绿色高亮行表示完全符合您查询条件的峰值</li>
                                <li>同一化合物的其他峰值也会显示，但不会高亮</li>
                                <li>表格包含化合物名称、质子类型、多重峰信息和精确化学位移值</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- 字符串搜索功能 -->
                    <div class="help-section">
                        <div class="section-icon-container">
                            <div class="section-icon search-text-icon">
                                <i class="fas fa-keyboard"></i>
                            </div>
                        </div>
                        <div class="section-content">
                            <h6 class="section-title">字符串搜索功能</h6>
                            <p class="section-description">使用顶部搜索框可以快速查找特定化合物：</p>
                            <ul class="section-list">
                                <li>输入化合物名称（如 methanol、acetone 等）</li>
                                <li>系统将实时过滤显示匹配的化合物</li>
                            </ul>
                            <div class="section-note">
                                <i class="fas fa-info-circle"></i>
                                注意：字符串搜索仅针对化合物名称列进行匹配，不包括质子类型和多重峰信息。
                            </div>
                        </div>
                    </div>
                    
                    <!-- 提示 -->
                    <div class="help-section hint-section">
                        <div class="section-icon-container">
                            <div class="section-icon hint-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                        </div>
                        <div class="section-content">
                            <h6 class="section-title">使用提示</h6>
                            <p class="section-description">提高查询效率的建议：</p>
                            <ul class="section-list">
                                <li>如果未找到任何峰值，请尝试增大阈值范围</li>
                                <li>较小的阈值会产生更精确的结果，但可能会遗漏近似值</li>
                                <li>使用字符串搜索可以快速定位特定化合物</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer help-modal-footer">
                <button type="button" class="btn btn-primary help-close-btn" data-dismiss="modal">
                    <i class="fas fa-check"></i> 我知道了
                </button>
            </div>
        </div>
    </div>
</div>
    
</body>
</html>
</body>
</html>
